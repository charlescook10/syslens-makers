# Stage 1: build
FROM ubuntu:22.04 AS builder
RUN apt-get update && apt-get install -y build-essential
WORKDIR /app
COPY . /app
RUN make collector

# Stage 2: final image
FROM ubuntu:22.04
WORKDIR /app
COPY --from=builder /app/collector /usr/local/bin/collector
EXPOSE 8080
CMD ["/usr/local/bin/collector"]
